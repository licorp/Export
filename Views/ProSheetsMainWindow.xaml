<Window x:Class="ProSheetsAddin.Views.ProSheetsMainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:ProSheetsAddin"
        Title="Export +" 
        Height="750" Width="1200"
        MinHeight="600" MinWidth="800"
        WindowStartupLocation="CenterScreen"
        DataContext="{Binding RelativeSource={RelativeSource Self}}">

    <Window.Resources>
        <!-- Converters -->
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        
        <!-- Professional Button Styles -->
        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#2196F3"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#2196F3"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"
                                              Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#1976D2"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#1565C0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SecondaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="#666"/>
            <Setter Property="BorderBrush" Value="#E1E1E1"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"
                                              Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#F5F5F5"/>
                                <Setter Property="BorderBrush" Value="#CCCCCC"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#EEEEEE"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- DataGrid Styles -->
        <Style x:Key="HeaderlessDataGrid" TargetType="DataGrid">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#E1E1E1"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#F0F0F0"/>
            <Setter Property="RowHeight" Value="35"/>
            <Setter Property="HeadersVisibility" Value="None"/>
            <Setter Property="SelectionMode" Value="Extended"/>
            <Setter Property="AlternatingRowBackground" Value="#FAFAFA"/>
        </Style>

        <Style x:Key="CustomHeaderTextBlock" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#333"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="10,8"/>
        </Style>
    </Window.Resources>

    <Grid Background="#FAFAFA">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Main Content -->
        <TabControl Grid.Row="0" Background="White" BorderThickness="0">
            <!-- Sheets Tab -->
            <TabItem x:Name="SheetsTab">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <Ellipse Fill="#4CAF50" Width="8" Height="8" Margin="0,0,5,0"/>
                        <TextBlock Text="Sheets"/>
                    </StackPanel>
                </TabItem.Header>
                
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Profile Manager Bar -->
                    <Border Grid.Row="0" Background="#F8F8F8" BorderBrush="#E1E1E1" BorderThickness="1" 
                            CornerRadius="3" Padding="15" Margin="763,15,0,15">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Profile:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="SemiBold"/>
                            <ComboBox x:Name="ProfileComboBox" Width="200" Height="28" Margin="0,0,10,0"
                                      ItemsSource="{Binding Profiles}"
                                      SelectedItem="{Binding SelectedProfile}"
                                      DisplayMemberPath="ProfileName"
                                      SelectionChanged="ProfileComboBox_SelectionChanged"/>
                            <Button Content="+" Width="28" Height="28" Margin="0,0,5,0" 
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    ToolTip="Add new profile"
                                    Click="AddProfile_Click"/>
                            <Button Content="ðŸ’¾" Width="28" Height="28" Margin="0,0,5,0"
                                    Style="{StaticResource SecondaryButtonStyle}" 
                                    ToolTip="Save current profile"
                                    Click="SaveProfile_Click"/>
                            <Button Content="ðŸ—‘" Width="28" Height="28" Margin="0,0,5,0"
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    ToolTip="Delete profile"
                                    Click="DeleteProfile_Click"/>
                            <Button Content="ðŸ“" Width="28" Height="28" Margin="0,0,10,0"
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    ToolTip="Import ProSheets profile (*.json)"
                                    Click="ImportProfile_Click"/>
                        </StackPanel>
                    </Border>

                    <!-- Top Control Bar -->
                    <Grid Grid.Row="1" Margin="0,0,0,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Radio Buttons for Sheets/Views -->
                        <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0,0,20,0">
                            <RadioButton x:Name="SheetsRadio" Content="Sheets" IsChecked="True" GroupName="ViewType" 
                                         VerticalAlignment="Center" Margin="0,0,15,0" FontSize="14"
                                         Checked="SheetsRadio_Checked"/>
                            <RadioButton x:Name="ViewsRadio" Content="Views" GroupName="ViewType" 
                                         VerticalAlignment="Center" FontSize="14"
                                         Checked="ViewsRadio_Checked"/>
                        </StackPanel>

                        <!-- View/Sheet Set Dropdown -->
                        <TextBlock Grid.Column="1" Text="View/Sheet Set:" VerticalAlignment="Center" Margin="0,0,10,0" FontSize="13"/>
                        <ComboBox Grid.Column="2" x:Name="ViewSheetSetCombo" Width="150" Height="28" Margin="0,0,10,0">
                            <ComboBoxItem Content="&lt;None&gt;" IsSelected="True"/>
                            <ComboBoxItem Content="All Sheets"/>
                            <ComboBoxItem Content="Architectural"/>
                            <ComboBoxItem Content="Structural"/>
                            <ComboBoxItem Content="MEP"/>
                        </ComboBox>

                        <!-- Filter and Save Buttons -->
                        <Button Grid.Column="3" Content="Filter" Style="{StaticResource SecondaryButtonStyle}" 
                                Width="60" Height="40" Margin="0,0,5,0" FontSize="12"/>
                        
                        <!-- Custom File Name Actions -->
                        <StackPanel Grid.Column="4" Orientation="Horizontal" Margin="0,0,10,0">
                            <Button Content="Reset Names" Style="{StaticResource SecondaryButtonStyle}" 
                                    Width="80" Height="28" Margin="0,0,5,0" FontSize="11"
                                    ToolTip="Reset custom file names to default"
                                    Click="ResetFileNames_Click"/>
                            <Button Content="Apply Template" Style="{StaticResource PrimaryButtonStyle}" 
                                    Width="90" Height="28" Margin="0,0,5,0" FontSize="11"
                                    ToolTip="Apply file naming template from current profile"
                                    Click="ApplyTemplate_Click"/>
                        </StackPanel>

                        <!-- Search TextBox -->
                        <TextBox Grid.Column="5" x:Name="SearchTextBox" Width="200" Height="40" 
                                 VerticalContentAlignment="Center" FontSize="13"
                                 Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}">
                            <TextBox.Style>
                                <Style TargetType="TextBox">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="TextBox">
                                                <Border Background="White" BorderBrush="#E1E1E1" BorderThickness="1" CornerRadius="3">
                                                    <Grid>
                                                        <ScrollViewer x:Name="PART_ContentHost" Background="Transparent" BorderThickness="0" Margin="8,5"/>
                                                        <TextBlock Text="Search..." Foreground="#999" Margin="10,8" 
                                                                   IsHitTestVisible="False" Visibility="{Binding Text.IsEmpty, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                                    </Grid>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </TextBox.Style>
                        </TextBox>
                    </Grid>

                    <!-- Custom Column Headers -->
                    <Grid Grid.Row="2" Background="#F8F8F8" Height="35">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="40"/>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="80"/>
                            <ColumnDefinition Width="200"/>
                        </Grid.ColumnDefinitions>

                        <Border Grid.Column="0" BorderBrush="#E1E1E1" BorderThickness="0,0,1,1">
                            <CheckBox x:Name="SelectAllCheckBox" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <Border Grid.Column="1" BorderBrush="#E1E1E1" BorderThickness="0,0,1,1">
                            <TextBlock Text="Sheet Number" Style="{StaticResource CustomHeaderTextBlock}"/>
                        </Border>
                        <Border Grid.Column="2" BorderBrush="#E1E1E1" BorderThickness="0,0,1,1">
                            <TextBlock Text="Sheet Name" Style="{StaticResource CustomHeaderTextBlock}"/>
                        </Border>
                        <Border Grid.Column="3" BorderBrush="#E1E1E1" BorderThickness="0,0,1,1">
                            <TextBlock Text="Revision" Style="{StaticResource CustomHeaderTextBlock}"/>
                        </Border>
                        <Border Grid.Column="4" BorderBrush="#E1E1E1" BorderThickness="0,0,1,1">
                            <TextBlock Text="Size" Style="{StaticResource CustomHeaderTextBlock}"/>
                        </Border>
                        <Border Grid.Column="5" BorderBrush="#E1E1E1" BorderThickness="0,0,0,1">
                            <TextBlock Text="Custom File Name" Style="{StaticResource CustomHeaderTextBlock}"/>
                        </Border>
                    </Grid>

                    <!-- DataGrid -->
                    <DataGrid Grid.Row="3" x:Name="SheetsDataGrid" 
                              Style="{StaticResource HeaderlessDataGrid}"
                              ItemsSource="{Binding Sheets}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              CanUserResizeRows="False"
                              SelectionChanged="SheetsDataGrid_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Width="40">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <CheckBox IsChecked="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" 
                                                  HorizontalAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            
                            <DataGridTextColumn Width="120" Binding="{Binding SheetNumber}">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            
                            <DataGridTextColumn Width="*" Binding="{Binding SheetName}">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            
                            <DataGridTextColumn Width="100" Binding="{Binding Revision}">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            
                            <DataGridTextColumn Width="80" Binding="{Binding Size}">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            
                            <DataGridTemplateColumn Width="200">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBox Text="{Binding CustomFileName, UpdateSourceTrigger=PropertyChanged}" 
                                                 Margin="8,5" Background="Transparent" BorderThickness="0"
                                                 VerticalContentAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Views DataGrid -->
                    <DataGrid Grid.Row="3" x:Name="ViewsDataGrid" 
                              Style="{StaticResource HeaderlessDataGrid}"
                              ItemsSource="{Binding Views}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              CanUserResizeRows="False"
                              Visibility="Collapsed"
                              SelectionChanged="ViewsDataGrid_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Width="40">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <CheckBox IsChecked="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" 
                                                  HorizontalAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            
                            <DataGridTextColumn Width="120" Binding="{Binding ViewType}">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Width="*" Binding="{Binding ViewName}">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            
                            <DataGridTextColumn Width="80" Binding="{Binding Scale}">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            
                            <DataGridTemplateColumn Width="200">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBox Text="{Binding CustomFileName, UpdateSourceTrigger=PropertyChanged}" 
                                                 Margin="8,5" Background="Transparent" BorderThickness="0"
                                                 VerticalContentAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Bottom Status -->
                    <Grid Grid.Row="4" Margin="0,15,0,0">
                        <TextBlock x:Name="SelectionStatusText" 
                                   Text="0 of 0 sheets selected" 
                                   FontSize="12" 
                                   Foreground="#666" 
                                   VerticalAlignment="Center"/>
                    </Grid>
                </Grid>
            </TabItem>
            
            <!-- Format Settings Tab -->
            <TabItem x:Name="FormatsTab">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <Ellipse Fill="#FF9800" Width="8" Height="8" Margin="0,0,5,0"/>
                        <TextBlock Text="Formats"/>
                    </StackPanel>
                </TabItem.Header>
                
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Format Selection -->
                    <Border Grid.Row="0" Background="#F8F8F8" BorderBrush="#E1E1E1" BorderThickness="1" 
                            CornerRadius="3" Padding="15" Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="Export Formats" FontWeight="SemiBold" Margin="0,0,0,10"/>
                            <WrapPanel>
                                <CheckBox Content="PDF" Margin="0,0,15,0" 
                                          IsChecked="{Binding ExportSettings.IsPdfSelected, Mode=TwoWay}"/>
                                <CheckBox Content="DWG" Margin="0,0,15,0" 
                                          IsChecked="{Binding ExportSettings.IsDwgSelected, Mode=TwoWay}"/>
                                <CheckBox Content="JPG" Margin="0,0,15,0" 
                                          IsChecked="{Binding ExportSettings.IsJpgSelected, Mode=TwoWay}"/>
                                <CheckBox Content="PNG" Margin="0,0,15,0" 
                                          IsChecked="{Binding ExportSettings.IsPngSelected, Mode=TwoWay}"/>
                                <CheckBox Content="IFC" Margin="0,0,15,0" 
                                          IsChecked="{Binding ExportSettings.IsIfcSelected, Mode=TwoWay}"/>
                            </WrapPanel>
                        </StackPanel>
                    </Border>

                    <!-- Format Settings Details -->
                    <TabControl Grid.Row="1" Background="White" BorderThickness="1" BorderBrush="#E1E1E1">
                        <TabItem Header="PDF Settings" IsEnabled="{Binding ExportSettings.IsPdfSelected}">
                            <Grid Margin="15">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                                    <TextBlock Text="Paper Size:" Width="100" VerticalAlignment="Center"/>
                                    <ComboBox Width="150" SelectedItem="{Binding ExportSettings.PaperSize}">
                                        <ComboBoxItem Content="A3"/>
                                        <ComboBoxItem Content="A4"/>
                                        <ComboBoxItem Content="A2"/>
                                        <ComboBoxItem Content="A1"/>
                                        <ComboBoxItem Content="A0"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                                    <TextBlock Text="DPI:" Width="100" VerticalAlignment="Center"/>
                                    <ComboBox Width="150" SelectedItem="{Binding ExportSettings.Resolution}">
                                        <ComboBoxItem Content="150"/>
                                        <ComboBoxItem Content="300"/>
                                        <ComboBoxItem Content="600"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <CheckBox Grid.Row="2" Content="Hide Crop Boundaries" 
                                          IsChecked="{Binding ExportSettings.HideCropBoundaries}"/>
                            </Grid>
                        </TabItem>
                        
                        <TabItem Header="DWG Settings" IsEnabled="{Binding ExportSettings.IsDwgSelected}">
                            <Grid Margin="15">
                                <StackPanel>
                                    <CheckBox Content="Export objects as AutoCAD blocks" Margin="0,0,0,10"
                                              IsChecked="{Binding ExportSettings.ExportAsBlocks}"/>
                                    <CheckBox Content="Use shared coordinates" Margin="0,0,0,10"
                                              IsChecked="{Binding ExportSettings.UseSharedCoordinates}"/>
                                    <CheckBox Content="Create separate files for each sheet" 
                                              IsChecked="{Binding ExportSettings.CreateSeparateFiles}"/>
                                </StackPanel>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Bottom Section -->
        <Border Grid.Row="1" BorderBrush="LightGray" BorderThickness="0,1,0,0" Padding="15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" x:Name="BottomStatusText" 
                           Text="0 sheets selected" FontSize="12" VerticalAlignment="Center"/>
                <Button Grid.Column="1" Content="Settings" 
                        Style="{StaticResource SecondaryButtonStyle}"
                        Width="80" Height="40" Margin="0,0,10,0"/>
                <Button Grid.Column="2" Content="Close" 
                        Style="{StaticResource SecondaryButtonStyle}"
                        Width="80" Height="40" Margin="0,0,10,0"
                        Click="CloseButton_Click"/>
                <Button Grid.Column="3" Content="Export +" 
                        Style="{StaticResource PrimaryButtonStyle}"
                        Width="80" Height="40"
                        Click="ExportButton_Click"/>
            </Grid>
        </Border>
    </Grid>
</Window>