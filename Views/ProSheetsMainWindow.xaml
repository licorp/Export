<Window x:Class="ProSheetsAddin.Views.ProSheetsMainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:ProSheetsAddin"
        xmlns:utils="clr-namespace:ProSheetsAddin.Utils"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="Export +" 
        Height="750" Width="1200"
        MinHeight="600" MinWidth="800"
        WindowStartupLocation="CenterScreen"
        ShowInTaskbar="True"
        Topmost="False"
        WindowState="Normal"
        ResizeMode="CanResize"
        DataContext="{Binding RelativeSource={RelativeSource Self}}">

    <Window.Resources>
        <!-- Converters -->
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        
        <!-- Professional Button Styles -->
        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#2196F3"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#2196F3"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"
                                              Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#1976D2"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#1565C0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SecondaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="#666"/>
            <Setter Property="BorderBrush" Value="#E1E1E1"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"
                                              Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#F5F5F5"/>
                                <Setter Property="BorderBrush" Value="#CCCCCC"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#EEEEEE"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- DataGrid Styles -->
        <Style x:Key="HeaderlessDataGrid" TargetType="DataGrid">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#E1E1E1"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#F0F0F0"/>
            <Setter Property="RowHeight" Value="35"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="SelectionMode" Value="Extended"/>
            <Setter Property="AlternatingRowBackground" Value="#FAFAFA"/>
        </Style>

        <Style x:Key="CustomHeaderTextBlock" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#333"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="10,8"/>
        </Style>
        
        <!-- Custom File Name Column Header Style (darker background) -->
        <Style x:Key="CustomFileNameHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#E8E8E8"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
        </Style>
    </Window.Resources>

    <Grid Background="#FAFAFA">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Main Content -->
        <TabControl x:Name="MainTabControl" Grid.Row="0" Background="White" BorderThickness="0"
                    SelectionChanged="MainTabControl_SelectionChanged">
            <!-- Sheets Tab -->
            <TabItem x:Name="SheetsTab">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <Ellipse Fill="#4CAF50" Width="8" Height="8" Margin="0,0,5,0"/>
                        <TextBlock Text="Sheets"/>
                    </StackPanel>
                </TabItem.Header>
                
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Profile Manager Bar -->
                    <Border Grid.Row="0" Background="#F8F8F8" BorderBrush="#E1E1E1" BorderThickness="1" 
                            CornerRadius="3" Padding="15" Margin="0,15,0,15">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Label bên trái -->
                            <TextBlock Grid.Column="0" Text="Profile:" VerticalAlignment="Center" 
                                       Margin="0,0,10,0" FontWeight="SemiBold" FontSize="14"/>
                            
                            <!-- ComboBox giữa -->
                            <ComboBox Grid.Column="1" x:Name="ProfileComboBox" Height="32" 
                                      MinWidth="200" MaxWidth="400" HorizontalAlignment="Stretch"
                                      Margin="0,0,10,0"
                                      ItemsSource="{Binding Profiles}"
                                      SelectedItem="{Binding SelectedProfile}"
                                      DisplayMemberPath="ProfileName"
                                      SelectionChanged="ProfileComboBox_SelectionChanged"/>
                            
                            <!-- Buttons bên phải -->
                            <StackPanel Grid.Column="2" Orientation="Horizontal">
                                <Button Content="Add" Width="80" Height="32" Margin="0,0,8,0" 
                                        Style="{StaticResource SecondaryButtonStyle}"
                                        ToolTip="Import profile from JSON file"
                                        Click="ImportProfile_Click"/>
                                <Button Content="Save" Width="80" Height="32" Margin="0,0,8,0"
                                        Style="{StaticResource SecondaryButtonStyle}" 
                                        ToolTip="Export profile to JSON file"
                                        Click="ExportProfile_Click"/>
                                <Button Content="Del" Width="80" Height="32" Margin="0,0,0,0"
                                        Style="{StaticResource SecondaryButtonStyle}"
                                        ToolTip="Delete current profile"
                                        Click="DeleteProfile_Click"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Top Control Bar - Ribbon -->
                    <Border Grid.Row="1" Background="White" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" 
                            Padding="10,8" Margin="0,0,0,15">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Radio Buttons for Sheets/Views -->
                            <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,15,0">
                                <RadioButton x:Name="SheetsRadio" Content="Sheets" IsChecked="True" GroupName="ViewType" 
                                             VerticalAlignment="Center" Margin="0,0,10,0" FontSize="12"
                                             Checked="SheetsRadio_Checked"/>
                                <RadioButton x:Name="ViewsRadio" Content="Views" GroupName="ViewType" 
                                             VerticalAlignment="Center" FontSize="12"
                                             Checked="ViewsRadio_Checked"/>
                            </StackPanel>

                            <!-- View/Sheet Set Label -->
                            <TextBlock Grid.Column="1" Text="View/Sheet Set" VerticalAlignment="Center" 
                                       Margin="0,0,8,0" FontSize="12"/>

                            <!-- Filter Checkbox + Dropdown -->
                            <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,8,0">
                                <CheckBox x:Name="FilterByVSCheckBox" 
                                         VerticalAlignment="Center"
                                         Margin="0,0,6,0"
                                         Checked="FilterByVSCheckBox_Checked"
                                         Unchecked="FilterByVSCheckBox_Unchecked"
                                         ToolTip="Enable filtering by View/Sheet Set"/>
                                
                                <ComboBox x:Name="ViewSheetSetCombo" Width="140" Height="24" 
                                          SelectionChanged="ViewSheetSetCombo_SelectionChanged"
                                          BorderBrush="#CCCCCC" BorderThickness="1" Background="White"
                                          Padding="6,2" FontSize="12">
                                    <ComboBoxItem Content="Filter by V/S Sets" IsSelected="True"/>
                                    <ComboBoxItem Content="All Sheets"/>
                                    <ComboBoxItem Content="Architectural"/>
                                    <ComboBoxItem Content="Structural"/>
                                    <ComboBoxItem Content="MEP"/>
                                    <ComboBoxItem Content="Site"/>
                                </ComboBox>
                            </StackPanel>

                            <!-- Save V/S Set Button -->
                            <Button Grid.Column="3" Content="Save V/S Set" Width="90" Height="24" 
                                    Margin="0,0,10,0" FontSize="12"
                                    Background="White" BorderBrush="#CCCCCC" BorderThickness="1"
                                    Click="SaveVSSet_Click"
                                    ToolTip="Save current selection as View/Sheet Set">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                CornerRadius="2" Padding="8,2">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#F0F0F0"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>

                            <!-- Search TextBox -->
                            <TextBox Grid.Column="5" x:Name="SearchTextBox" Width="200" Height="24" 
                                     VerticalContentAlignment="Center" FontSize="12"
                                     BorderBrush="#CCCCCC" BorderThickness="1"
                                     Padding="24,2,6,2"
                                     TextChanged="SearchTextBox_TextChanged">
                                <TextBox.Template>
                                    <ControlTemplate TargetType="TextBox">
                                        <Border Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                CornerRadius="2">
                                            <Grid>
                                                <ScrollViewer x:Name="PART_ContentHost" 
                                                             Margin="{TemplateBinding Padding}"
                                                             VerticalAlignment="Center"/>
                                                <TextBlock Text="🔍" 
                                                          HorizontalAlignment="Left" 
                                                          VerticalAlignment="Center"
                                                          Margin="6,0,0,0"
                                                          Foreground="#999999"
                                                          IsHitTestVisible="False"
                                                          FontSize="12"/>
                                            </Grid>
                                        </Border>
                                    </ControlTemplate>
                                </TextBox.Template>
                            </TextBox>
                        </Grid>
                    </Border>

                    <!-- DataGrid -->
                    <DataGrid Grid.Row="3" x:Name="SheetsDataGrid" 
                              Style="{StaticResource HeaderlessDataGrid}"
                              ItemsSource="{Binding Sheets}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              CanUserResizeRows="False"
                              CanUserResizeColumns="True"
                              SelectionChanged="SheetsDataGrid_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Width="40" CanUserResize="False" Header="">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <CheckBox IsChecked="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" 
                                                  HorizontalAlignment="Center"
                                                  VerticalAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            
                            <DataGridTextColumn Width="120" Binding="{Binding SheetNumber}" Header="Sheet Number" CanUserResize="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            
                            <DataGridTextColumn Width="*" Binding="{Binding SheetName}" Header="Sheet Name" CanUserResize="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            
                            <DataGridTextColumn Width="100" Binding="{Binding Revision}" Header="Revision" CanUserResize="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            
                            <DataGridTextColumn Width="120" Binding="{Binding PaperSize}" Header="Size" CanUserResize="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            
                            <DataGridTemplateColumn Width="*" CanUserResize="True">
                                <DataGridTemplateColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                        <Setter Property="Padding" Value="0"/>
                                        <Setter Property="Background" Value="#E8E8E8"/>
                                    </Style>
                                </DataGridTemplateColumn.HeaderStyle>
                                <DataGridTemplateColumn.Header>
                                    <Button Content="Custom File Name"
                                           HorizontalAlignment="Stretch"
                                           HorizontalContentAlignment="Left"
                                           Background="Transparent"
                                           BorderThickness="0"
                                           Padding="8,8"
                                           Cursor="Hand"
                                           FontWeight="SemiBold"
                                           Click="EditSelectedFilenames_Click"
                                           ToolTip="Click to edit filename for selected sheets">
                                        <Button.Style>
                                            <Style TargetType="Button">
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="Button">
                                                            <Border Background="{TemplateBinding Background}"
                                                                    BorderThickness="0"
                                                                    Padding="{TemplateBinding Padding}">
                                                                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                                                                VerticalAlignment="Center"/>
                                                            </Border>
                                                            <ControlTemplate.Triggers>
                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                    <Setter Property="Background" Value="#D0D0D0"/>
                                                                </Trigger>
                                                                <Trigger Property="IsPressed" Value="True">
                                                                    <Setter Property="Background" Value="#C0C0C0"/>
                                                                </Trigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </Button.Style>
                                    </Button>
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBox Text="{Binding CustomFileName, UpdateSourceTrigger=PropertyChanged}" 
                                                Margin="8,5" 
                                                Background="Transparent" 
                                                BorderThickness="0"
                                                IsReadOnly="True"
                                                VerticalContentAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Views DataGrid -->
                    <DataGrid Grid.Row="3" x:Name="ViewsDataGrid" 
                              Style="{StaticResource HeaderlessDataGrid}"
                              ItemsSource="{Binding Views}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              CanUserResizeRows="False"
                              CanUserResizeColumns="True"
                              Visibility="Collapsed"
                              SelectionChanged="ViewsDataGrid_SelectionChanged">
                        <DataGrid.Columns>
                            <!-- Checkbox Column -->
                            <DataGridTemplateColumn Width="40" Header="" CanUserResize="False">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <CheckBox IsChecked="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" 
                                                  HorizontalAlignment="Center"
                                                  VerticalAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            
                            <!-- View Name -->
                            <DataGridTextColumn Width="200" Binding="{Binding ViewName}" Header="View Name" CanUserResize="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <!-- View Type Dropdown -->
                            <DataGridTemplateColumn Width="100" Header="All View" CanUserResize="True">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <ComboBox ItemsSource="{Binding AvailableViewTypes}"
                                                 SelectedItem="{Binding ViewType, UpdateSourceTrigger=PropertyChanged}"
                                                 BorderThickness="0"
                                                 Background="Transparent"
                                                 Padding="4,2"
                                                 Margin="4,0">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding}" FontSize="11"/>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            
                            <!-- View Scale -->
                            <DataGridTextColumn Width="80" Binding="{Binding Scale}" Header="View Scale" CanUserResize="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            
                            <!-- Detail Level -->
                            <DataGridTextColumn Width="80" Binding="{Binding DetailLevel}" Header="Detail Level" CanUserResize="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            
                            <!-- Discipline -->
                            <DataGridTextColumn Width="100" Binding="{Binding Discipline}" Header="Discipline" CanUserResize="True">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Margin" Value="10,8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            
                            <!-- Custom File Name (Editable) -->
                            <DataGridTemplateColumn Width="*" CanUserResize="True">
                                <DataGridTemplateColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                        <Setter Property="Padding" Value="0"/>
                                        <Setter Property="Background" Value="#E8E8E8"/>
                                    </Style>
                                </DataGridTemplateColumn.HeaderStyle>
                                <DataGridTemplateColumn.Header>
                                    <Button Content="Custom File Name"
                                           HorizontalAlignment="Stretch"
                                           HorizontalContentAlignment="Left"
                                           Background="Transparent"
                                           BorderThickness="0"
                                           Padding="8,8"
                                           Cursor="Hand"
                                           FontWeight="SemiBold"
                                           Click="EditSelectedFilenames_Click"
                                           ToolTip="Click to edit filename for selected views">
                                        <Button.Style>
                                            <Style TargetType="Button">
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="Button">
                                                            <Border Background="{TemplateBinding Background}"
                                                                    BorderThickness="0"
                                                                    Padding="{TemplateBinding Padding}">
                                                                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                                                                VerticalAlignment="Center"/>
                                                            </Border>
                                                            <ControlTemplate.Triggers>
                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                    <Setter Property="Background" Value="#D0D0D0"/>
                                                                </Trigger>
                                                                <Trigger Property="IsPressed" Value="True">
                                                                    <Setter Property="Background" Value="#C0C0C0"/>
                                                                </Trigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </Button.Style>
                                    </Button>
                                </DataGridTemplateColumn.Header>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBox Text="{Binding CustomFileName, UpdateSourceTrigger=PropertyChanged}" 
                                                 Margin="8,5" Background="Transparent" BorderThickness="0"
                                                 IsReadOnly="True"
                                                 VerticalContentAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Bottom Status -->
                    <Grid Grid.Row="4" Margin="0,15,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Selection Statistics -->
                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <Border Background="#E3F2FD" BorderBrush="#2196F3" BorderThickness="1" 
                                    CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="📄" FontSize="16" Margin="0,0,5,0"/>
                                    <TextBlock x:Name="SheetsCountText" Text="0 sheets selected" 
                                               FontWeight="SemiBold" Foreground="#1976D2"/>
                                </StackPanel>
                            </Border>
                            
                            <Border Background="#E8F5E8" BorderBrush="#4CAF50" BorderThickness="1" 
                                    CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="👁️" FontSize="16" Margin="0,0,5,0"/>
                                    <TextBlock x:Name="ViewsCountText" Text="0 views selected" 
                                               FontWeight="SemiBold" Foreground="#388E3C"/>
                                </StackPanel>
                            </Border>
                            
                            <Border Background="#FFF3E0" BorderBrush="#FF9800" BorderThickness="1" 
                                    CornerRadius="3" Padding="10,5">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="📊" FontSize="16" Margin="0,0,5,0"/>
                                    <TextBlock x:Name="TotalItemsText" Text="Total: 0 items" 
                                               FontWeight="SemiBold" Foreground="#F57C00"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                        
                        <!-- Action Buttons -->
                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <Button Content="Select All" Width="100" Height="40" Margin="0,0,5,0"
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Click="SelectAll_Click"/>
                            <Button Content="Clear All" Width="100" Height="40" Margin="0,0,5,0"
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Click="ClearAll_Click"/>
                            <Button Content="Refresh" Width="80" Height="40"
                                    Style="{StaticResource SecondaryButtonStyle}"
                                    Click="Refresh_Click"/>
                        </StackPanel>
                    </Grid>
                </Grid>
            </TabItem>
            
            <!-- Format Settings Tab -->
            <TabItem x:Name="FormatsTab">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <Ellipse Fill="#FF9800" Width="8" Height="8" Margin="0,0,5,0"/>
                        <TextBlock Text="Formats"/>
                    </StackPanel>
                </TabItem.Header>
                
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Format Settings Details -->
                    <TabControl Grid.Row="0" Background="White" BorderThickness="1" BorderBrush="#E1E1E1">
                        <TabItem Header="Format" IsEnabled="{Binding ExportSettings.IsPdfSelected}">
                            <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <!-- Format Icons Row -->
                                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
                                        <!-- PDF -->
                                        <Border Background="#FFF3E0" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="PDFCheck" IsChecked="{Binding ExportSettings.IsPdfSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="📄" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="PDF" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#FF6D00"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- DWG -->
                                        <Border Background="#E3F2FD" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="DWGCheck" IsChecked="{Binding ExportSettings.IsDwgSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="📐" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="DWG" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#1976D2"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- DGN -->
                                        <Border Background="#F3E5F5" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="DGNCheck" IsChecked="{Binding ExportSettings.IsDgnSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="📋" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="DGN" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#7B1FA2"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- DWF -->
                                        <Border Background="#E8F5E9" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="DWFCheck" IsChecked="{Binding ExportSettings.IsDwfSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="📁" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="DWF" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#388E3C"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- NWC -->
                                        <Border Background="#FFF9C4" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="NWCCheck" IsChecked="{Binding ExportSettings.IsNwcSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="🔧" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="NWC" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#F57F17"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- IFC -->
                                        <Border Background="#E0F2F1" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="IFCCheck" IsChecked="{Binding ExportSettings.IsIfcSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="🏗️" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="IFC" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#00796B"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- IMG -->
                                        <Border Background="#FCE4EC" CornerRadius="3" Padding="10,5">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="IMGCheck" IsChecked="{Binding ExportSettings.IsImageSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="🖼️" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="IMG" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#C2185B"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>

                                    <!-- PDF Options Panel -->
                                    <Grid Grid.Row="1" Margin="0,0,0,15">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Paper Placement -->
                                        <GroupBox Header="Paper Placement" Grid.Column="0" Margin="0,0,5,0" 
                                                  BorderBrush="#E1E1E1" BorderThickness="1">
                                            <StackPanel Margin="10">
                                                <RadioButton Content="Center" IsChecked="True" Margin="0,0,0,8" FontSize="13"/>
                                                <RadioButton Content="Offset from corner" Margin="0,0,0,8" FontSize="13"/>
                                                <ComboBox x:Name="MarginCombo" Margin="20,0,0,10" FontSize="13">
                                                    <ComboBoxItem Content="No Margin" IsSelected="True"/>
                                                    <ComboBoxItem Content="Small"/>
                                                    <ComboBoxItem Content="Large"/>
                                                </ComboBox>
                                                <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                                    <TextBlock Text="X -" VerticalAlignment="Center" Width="25" FontSize="13"/>
                                                    <TextBox Width="50" Height="25" Margin="2,0,10,0" VerticalContentAlignment="Center"/>
                                                    <TextBlock Text="Y -" VerticalAlignment="Center" Width="25" FontSize="13"/>
                                                    <TextBox Width="50" Height="25" Margin="2,0,0,0" VerticalContentAlignment="Center"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </GroupBox>

                                        <!-- Hidden Line Views -->
                                        <GroupBox Header="Hidden Line Views" Grid.Column="1" Margin="5,0,5,0" 
                                                  BorderBrush="#E1E1E1" BorderThickness="1">
                                            <StackPanel Margin="10">
                                                <TextBlock Text="Remove Lines Using" Margin="0,0,0,8" FontWeight="SemiBold" FontSize="13"/>
                                                <RadioButton Content="Vector Processing" IsChecked="True" Margin="0,0,0,5" FontSize="13"/>
                                                <RadioButton Content="Raster Processing" FontSize="13"/>
                                                
                                                <TextBlock Text="Appearance" Margin="0,15,0,8" FontWeight="SemiBold" FontSize="13"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                    <TextBlock Text="Raster Quality" VerticalAlignment="Center" Width="95" FontSize="13"/>
                                                    <ComboBox x:Name="RasterQualityCombo" Width="120" FontSize="13">
                                                        <ComboBoxItem Content="Low"/>
                                                        <ComboBoxItem Content="Medium"/>
                                                        <ComboBoxItem Content="High" IsSelected="True"/>
                                                    </ComboBox>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="Colors" VerticalAlignment="Center" Width="95" FontSize="13"/>
                                                    <ComboBox x:Name="ColorsCombo" Width="120" FontSize="13">
                                                        <ComboBoxItem Content="Color" IsSelected="True"/>
                                                        <ComboBoxItem Content="Black and White"/>
                                                        <ComboBoxItem Content="Grayscale"/>
                                                    </ComboBox>
                                                </StackPanel>
                                            </StackPanel>
                                        </GroupBox>

                                        <!-- Options Panel -->
                                        <GroupBox Header="Options" Grid.Column="2" Margin="5,0,0,0" 
                                                  BorderBrush="#E1E1E1" BorderThickness="1">
                                            <StackPanel Margin="10">
                                                <CheckBox Content="View links in blue (Color prints only)" Margin="0,0,0,5" FontSize="13"/>
                                                <CheckBox Content="Hide ref/work planes" IsChecked="True" Margin="0,0,0,5" FontSize="13"/>
                                                <CheckBox Content="Hide unreferenced view tags" IsChecked="True" Margin="0,0,0,5" FontSize="13"/>
                                                <CheckBox Content="Hide scope boxes" IsChecked="True" Margin="0,0,0,5" FontSize="13"/>
                                                <CheckBox Content="Hide crop boundaries" IsChecked="{Binding ExportSettings.HideCropBoundaries}" 
                                                          Margin="0,0,0,5" FontSize="13"/>
                                                <CheckBox Content="Replace halftone with thin lines" Margin="0,0,0,5" FontSize="13"/>
                                                <CheckBox Content="Region edges mask coincident lines" IsChecked="True" FontSize="13"/>
                                            </StackPanel>
                                        </GroupBox>
                                    </Grid>

                                    <!-- Zoom, Printer & File Options -->
                                    <Grid Grid.Row="2">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Zoom Section -->
                                        <GroupBox Header="Zoom" Grid.Column="0" Margin="0,0,5,0" 
                                                  BorderBrush="#E1E1E1" BorderThickness="1">
                                            <StackPanel Margin="10">
                                                <RadioButton Content="Fit to Page" Margin="0,0,0,8" FontSize="13"/>
                                                <RadioButton Content="Zoom" IsChecked="True" Margin="0,0,0,8" FontSize="13"/>
                                                <StackPanel Orientation="Horizontal" Margin="20,0,0,0">
                                                    <TextBox Width="60" Text="100" Height="25" VerticalContentAlignment="Center" 
                                                             HorizontalContentAlignment="Right" FontSize="13"/>
                                                    <TextBlock Text="% Size" VerticalAlignment="Center" Margin="5,0,0,0" FontSize="13"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </GroupBox>

                                        <!-- Printer Section -->
                                        <GroupBox Header="Printer" Grid.Column="1" Margin="5,0,5,0" 
                                                  BorderBrush="#E1E1E1" BorderThickness="1">
                                            <StackPanel Margin="10">
                                                <TextBlock Text="Printer" Margin="0,0,0,8" FontWeight="SemiBold" FontSize="13"/>
                                                <ComboBox x:Name="PrinterCombo" FontSize="13">
                                                    <ComboBoxItem Content="PDF24" IsSelected="True"/>
                                                    <ComboBoxItem Content="Adobe PDF"/>
                                                    <ComboBoxItem Content="Bluebeam PDF"/>
                                                    <ComboBoxItem Content="Microsoft Print to PDF"/>
                                                </ComboBox>
                                            </StackPanel>
                                        </GroupBox>

                                        <!-- File Options Section -->
                                        <GroupBox Header="File" Grid.Column="2" Margin="5,0,0,0" 
                                                  BorderBrush="#E1E1E1" BorderThickness="1">
                                            <StackPanel Margin="10">
                                                <RadioButton Content="Create separate files" IsChecked="True" Margin="0,0,0,5" FontSize="13"/>
                                                <RadioButton Content="Combine multiple views/sheets into a single file" 
                                                             Margin="0,0,0,10" FontSize="13"/>
                                                
                                                <CheckBox x:Name="KeepPaperSizeCheckBox" Content="Keep Paper Size &amp; Orientation" 
                                                          Margin="0,0,0,15" FontSize="13"/>

                                                <Button Content="Custom File Name" Height="30" Margin="0,0,0,5" 
                                                        FontSize="13" Click="EditSelectedFilenames_Click"
                                                        IsEnabled="{Binding ElementName=KeepPaperSizeCheckBox, Path=IsChecked}"/>
                                                <Button Content="Order sheets and views" Height="30" 
                                                        FontSize="13"
                                                        IsEnabled="{Binding ElementName=KeepPaperSizeCheckBox, Path=IsChecked}"/>
                                            </StackPanel>
                                        </GroupBox>
                                    </Grid>
                                </Grid>
                            </ScrollViewer>
                        </TabItem>
                        
                        <TabItem Header="DWG Settings" IsEnabled="{Binding ExportSettings.IsDwgSelected}">
                            <Grid Margin="15">
                                <StackPanel>
                                    <CheckBox Content="Export objects as AutoCAD blocks" Margin="0,0,0,10"
                                              IsChecked="{Binding ExportSettings.ExportAsBlocks}"/>
                                    <CheckBox Content="Use shared coordinates" Margin="0,0,0,10"
                                              IsChecked="{Binding ExportSettings.UseSharedCoordinates}"/>
                                    <CheckBox Content="Create separate files for each sheet" 
                                              IsChecked="{Binding ExportSettings.CreateSeparateFiles}"/>
                                </StackPanel>
                            </Grid>
                        </TabItem>

                        <!-- NWC Settings Tab -->
                        <TabItem Header="NWC Settings" IsEnabled="{Binding ExportSettings.IsNwcSelected}">
                            <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="15">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <!-- Format Icons Row -->
                                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
                                        <!-- PDF -->
                                        <Border Background="#FFF3E0" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="PDFCheckNWC" IsChecked="{Binding ExportSettings.IsPdfSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="📄" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="PDF" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#FF6D00"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- DWG -->
                                        <Border Background="#E3F2FD" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="DWGCheckNWC" IsChecked="{Binding ExportSettings.IsDwgSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="📐" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="DWG" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#1976D2"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- DGN -->
                                        <Border Background="#F3E5F5" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="DGNCheckNWC" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="📋" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="DGN" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#7B1FA2"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- DWF -->
                                        <Border Background="#E8F5E9" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="DWFCheckNWC" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="📁" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="DWF" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#388E3C"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- NWC (Active) -->
                                        <Border Background="#FFF9C4" CornerRadius="3" Padding="10,5" Margin="0,0,10,0"
                                                BorderBrush="#F57F17" BorderThickness="2">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="NWCCheckNWC" IsChecked="True" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="🔧" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="NWC" FontWeight="Bold" VerticalAlignment="Center" Foreground="#F57F17"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- IFC -->
                                        <Border Background="#E0F2F1" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="IFCCheckNWC" IsChecked="{Binding ExportSettings.IsIfcSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="🏗️" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="IFC" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#00796B"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- IMG -->
                                        <Border Background="#FCE4EC" CornerRadius="3" Padding="10,5">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="IMGCheckNWC" IsChecked="{Binding ExportSettings.IsImageSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="🖼️" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="IMG" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#C2185B"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>

                                    <!-- NWC Options -->
                                    <Grid Grid.Row="1">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Standard options -->
                                        <GroupBox Header="Standard options" Grid.Column="0" Margin="0,0,10,0" 
                                                  BorderBrush="#E1E1E1" BorderThickness="1">
                                            <StackPanel Margin="10">
                                                <CheckBox Content="Convert construction parts" IsChecked="True" 
                                                          Margin="0,0,0,8" FontSize="13"/>
                                                <CheckBox Content="Convert element Ids" IsChecked="True" 
                                                          Margin="0,0,0,8" FontSize="13"/>
                                                
                                                <!-- Convert element parameters -->
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                    <TextBlock Text="Convert element parameters" VerticalAlignment="Center" 
                                                               Width="180" FontSize="13"/>
                                                    <ComboBox x:Name="ElementParamsCombo" Width="120" FontSize="13">
                                                        <ComboBoxItem Content="Elements" IsSelected="True"/>
                                                        <ComboBoxItem Content="Instances"/>
                                                        <ComboBoxItem Content="Types"/>
                                                    </ComboBox>
                                                </StackPanel>

                                                <CheckBox Content="Convert element properties" IsChecked="True" 
                                                          Margin="0,0,0,8" FontSize="13"/>
                                                <CheckBox Content="Convert linked files" 
                                                          Margin="0,0,0,8" FontSize="13"/>
                                                <CheckBox Content="Convert room as attribute" IsChecked="True" 
                                                          Margin="0,0,0,8" FontSize="13"/>
                                                <CheckBox Content="Convert URLs" IsChecked="True" 
                                                          Margin="0,0,0,8" FontSize="13"/>

                                                <!-- Coordinates -->
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                    <TextBlock Text="Coordinates" VerticalAlignment="Center" 
                                                               Width="180" FontSize="13"/>
                                                    <ComboBox x:Name="CoordinatesCombo" Width="120" FontSize="13">
                                                        <ComboBoxItem Content="Shared" IsSelected="True"/>
                                                        <ComboBoxItem Content="Internal"/>
                                                        <ComboBoxItem Content="Project Base"/>
                                                        <ComboBoxItem Content="Survey"/>
                                                    </ComboBox>
                                                </StackPanel>

                                                <CheckBox Content="Divide file into levels" IsChecked="True" 
                                                          Margin="0,0,0,8" FontSize="13"/>
                                                <CheckBox Content="Export room geometry" 
                                                          Margin="0,0,0,8" FontSize="13"/>
                                                <CheckBox Content="Try and find missing materials" IsChecked="True" 
                                                          FontSize="13"/>
                                            </StackPanel>
                                        </GroupBox>

                                        <!-- Revit 2020 & above options -->
                                        <GroupBox Header="Revit 2020 &amp; above" Grid.Column="1" 
                                                  BorderBrush="#E1E1E1" BorderThickness="1">
                                            <StackPanel Margin="10">
                                                <CheckBox Content="Convert linked CAD format" 
                                                          Margin="0,0,0,8" FontSize="13"/>
                                                <CheckBox Content="Convert lights" 
                                                          Margin="0,0,0,15" FontSize="13"/>

                                                <!-- Faceting factor -->
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="Faceting factor" VerticalAlignment="Center" 
                                                               Width="120" FontSize="13"/>
                                                    <TextBox x:Name="FacetingFactorBox" Width="80" Height="25" 
                                                             Text="1" VerticalContentAlignment="Center" 
                                                             HorizontalContentAlignment="Right" FontSize="13"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </GroupBox>
                                    </Grid>
                                </Grid>
                            </ScrollViewer>
                        </TabItem>

                        <!-- IFC Settings Tab -->
                        <TabItem Header="IFC Settings" IsEnabled="{Binding ExportSettings.IsIfcSelected}">
                            <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="15">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <!-- Format Icons Row -->
                                    <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,20">
                                        <!-- PDF -->
                                        <Border Background="#FFEBEE" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="PDFCheckIFC" IsChecked="{Binding ExportSettings.IsPdfSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="📄" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="PDF" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#D32F2F"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- DWG -->
                                        <Border Background="#E3F2FD" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="DWGCheckIFC" IsChecked="{Binding ExportSettings.IsDwgSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="📐" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="DWG" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#1976D2"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- DGN -->
                                        <Border Background="#F3E5F5" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="DGNCheckIFC" IsChecked="{Binding ExportSettings.IsDgnSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="📋" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="DGN" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#7B1FA2"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- DWF -->
                                        <Border Background="#E8F5E9" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="DWFCheckIFC" IsChecked="{Binding ExportSettings.IsDwfSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="📁" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="DWF" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#388E3C"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- NWC -->
                                        <Border Background="#FFF9C4" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="NWCCheckIFC" IsChecked="{Binding ExportSettings.IsNwcSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="🔧" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="NWC" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#F57F17"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- IFC - Highlighted -->
                                        <Border Background="#E0F2F1" BorderBrush="#00796B" BorderThickness="2" 
                                                CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="IFCCheckIFC" IsChecked="{Binding ExportSettings.IsIfcSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="🏗️" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="IFC" FontWeight="Bold" VerticalAlignment="Center" Foreground="#00796B"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- IMG -->
                                        <Border Background="#FCE4EC" CornerRadius="3" Padding="10,5">
                                            <StackPanel Orientation="Horizontal">
                                                <CheckBox x:Name="IMGCheckIFC" IsChecked="{Binding ExportSettings.IsImageSelected}" 
                                                          VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="🖼️" FontSize="20" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="IMG" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#C2185B"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>

                                    <!-- IFC Settings Content - 3 Columns -->
                                    <Grid Grid.Row="1">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Column 1: Setup & General + Additional Contents -->
                                        <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                            <!-- Setup & General -->
                                            <GroupBox Header="Setup &amp; General" Margin="0,0,0,0"
                                                      BorderBrush="#E1E1E1" BorderThickness="1">
                                                <StackPanel Margin="10">
                                                    <!-- Current Setup -->
                                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                                        <TextBlock Text="Current Setup" VerticalAlignment="Center" Width="100" FontSize="13"/>
                                                        <ComboBox x:Name="CurrentSetupComboIFC" Width="160" FontSize="13">
                                                            <ComboBoxItem Content="&lt;In-Session Setup&gt;" IsSelected="True"/>
                                                            <ComboBoxItem Content="Default"/>
                                                        </ComboBox>
                                                    </StackPanel>

                                                    <!-- IFC Version -->
                                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                        <TextBlock Text="IFC Version" VerticalAlignment="Center" Width="100" FontSize="13"/>
                                                        <ComboBox x:Name="IFCVersionComboIFC" Width="160" FontSize="13">
                                                            <ComboBoxItem Content="IFC 2x3 Coordination View 2.0" IsSelected="True"/>
                                                            <ComboBoxItem Content="IFC 4 Reference View"/>
                                                            <ComboBoxItem Content="IFC 2x3 Coordination View"/>
                                                            <ComboBoxItem Content="IFC 4 Design Transfer View"/>
                                                        </ComboBox>
                                                    </StackPanel>

                                                    <!-- File Type -->
                                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                        <TextBlock Text="File Type" VerticalAlignment="Center" Width="100" FontSize="13"/>
                                                        <ComboBox x:Name="IFCFileTypeComboIFC" Width="160" FontSize="13">
                                                            <ComboBoxItem Content="IFC" IsSelected="True"/>
                                                            <ComboBoxItem Content="IFCZIP"/>
                                                            <ComboBoxItem Content="IFCXML"/>
                                                        </ComboBox>
                                                    </StackPanel>

                                                    <!-- Phase to export -->
                                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                        <TextBlock Text="Phase to export" VerticalAlignment="Center" Width="100" FontSize="13"/>
                                                        <ComboBox x:Name="IFCPhaseComboIFC" Width="160" FontSize="13">
                                                            <ComboBoxItem Content="Default phase to export" IsSelected="True"/>
                                                            <ComboBoxItem Content="Existing"/>
                                                            <ComboBoxItem Content="New Construction"/>
                                                        </ComboBox>
                                                    </StackPanel>

                                                    <!-- Space boundaries -->
                                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                        <TextBlock Text="Space boundaries" VerticalAlignment="Center" Width="100" FontSize="13"/>
                                                        <ComboBox x:Name="SpaceBoundariesComboIFC" Width="160" FontSize="13">
                                                            <ComboBoxItem Content="None" IsSelected="True"/>
                                                            <ComboBoxItem Content="1st Level"/>
                                                            <ComboBoxItem Content="2nd Level"/>
                                                        </ComboBox>
                                                    </StackPanel>

                                                    <!-- Project Origin -->
                                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                                                        <TextBlock Text="Project Origin" VerticalAlignment="Center" Width="100" FontSize="13"/>
                                                        <ComboBox x:Name="ProjectOriginComboIFC" Width="160" FontSize="13">
                                                            <ComboBoxItem Content="Shared Coordinates" IsSelected="True"/>
                                                            <ComboBoxItem Content="Site Survey Point"/>
                                                            <ComboBoxItem Content="Project Base Point"/>
                                                            <ComboBoxItem Content="Internal Origin"/>
                                                        </ComboBox>
                                                    </StackPanel>

                                                    <!-- Checkboxes -->
                                                    <CheckBox Content="Split walls and columns by level" Margin="0,0,0,8" FontSize="13"/>
                                                    <CheckBox Content="Include Steel elements" IsChecked="True" Margin="0,0,0,15" FontSize="13"/>

                                                    <!-- Buttons -->
                                                    <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                                        <Button Content="File Header..." Width="120" Height="28" Margin="0,0,10,0" 
                                                                IsEnabled="False" FontSize="13"/>
                                                        <Button Content="Address..." Width="100" Height="28" 
                                                                IsEnabled="False" FontSize="13"/>
                                                    </StackPanel>
                                                </StackPanel>
                                            </GroupBox>

                                            <!-- Additional Contents -->
                                            <GroupBox Header="Additional Contents" Margin="0,20,0,0"
                                                      BorderBrush="#E1E1E1" BorderThickness="1">
                                                <StackPanel Margin="10">
                                                    <CheckBox Content="Export 2D plan view elements" 
                                                              IsChecked="False" 
                                                              Margin="0,0,0,8" FontSize="13"/>
                                                    <CheckBox Content="Export linked files as separate IFCs" 
                                                              IsChecked="False" 
                                                              Margin="0,0,0,8" FontSize="13"/>
                                                    <CheckBox Content="Export only elements visible in view" 
                                                              IsChecked="True" 
                                                              Margin="0,0,0,8" FontSize="13"/>
                                                    <CheckBox Content="Export rooms in 3D view" 
                                                              IsChecked="False" 
                                                              FontSize="13"/>
                                                </StackPanel>
                                            </GroupBox>
                                        </StackPanel>

                                        <!-- Column 2: Level of Details & Property Sets -->
                                        <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                            <!-- Level of details -->
                                            <GroupBox Header="Level of details" BorderBrush="#E1E1E1" BorderThickness="1" Margin="0,0,0,10">
                                                <StackPanel Margin="10">
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="Detail Level" VerticalAlignment="Center" Width="90" FontSize="13"/>
                                                        <ComboBox x:Name="DetailLevelComboIFC" Width="140" FontSize="13">
                                                            <ComboBoxItem Content="Coarse"/>
                                                            <ComboBoxItem Content="Medium" IsSelected="True"/>
                                                            <ComboBoxItem Content="Fine"/>
                                                        </ComboBox>
                                                    </StackPanel>
                                                </StackPanel>
                                            </GroupBox>

                                            <!-- Property Sets -->
                                            <GroupBox Header="Property Sets" BorderBrush="#E1E1E1" BorderThickness="1">
                                                <StackPanel Margin="10">
                                                    <CheckBox Content="Export Revit property sets" Margin="0,0,0,8" FontSize="13"/>
                                                    <CheckBox Content="Export IFC Common property sets" IsChecked="True" 
                                                              Margin="0,0,0,8" FontSize="13"/>
                                                    <CheckBox Content="Export base quantities" Margin="0,0,0,8" FontSize="13"/>
                                                    
                                                    <CheckBox Content="Export schedules as property sets" x:Name="ExportSchedulesCheckIFC"
                                                              Margin="0,0,0,5" FontSize="13"/>
                                                    <CheckBox Content="Export only schedules containing IFC, Pset, or Common in the title" 
                                                              Margin="20,0,0,8" FontSize="12" IsEnabled="False"/>
                                                    
                                                    <CheckBox Content="Export user defined property sets" x:Name="ExportUserPsetsCheckIFC"
                                                              Margin="0,0,0,5" FontSize="13"/>
                                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                        <TextBox x:Name="UserPsetsPathTextBoxIFC" Width="200" Height="25" 
                                                                 IsEnabled="{Binding ElementName=ExportUserPsetsCheckIFC, Path=IsChecked}" 
                                                                 FontSize="13" VerticalContentAlignment="Center"/>
                                                        <Button x:Name="BrowseUserPsetsButtonIFC" Content="..." Width="30" Height="25" 
                                                                IsEnabled="{Binding ElementName=ExportUserPsetsCheckIFC, Path=IsChecked}" 
                                                                utils:BrowseFileBehavior.TargetTextBoxName="UserPsetsPathTextBoxIFC"
                                                                utils:BrowseFileBehavior.DialogTitle="Select User-Defined Property Sets File"
                                                                utils:BrowseFileBehavior.FileFilter="Text Files (*.txt)|*.txt|All Files (*.*)|*.*"
                                                                Margin="5,0,0,0" FontSize="13"/>
                                                    </StackPanel>

                                                    <CheckBox Content="Export parameter mapping table" x:Name="ExportParamMappingCheckIFC"
                                                              Margin="0,0,0,5" FontSize="13"/>
                                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                                        <TextBox x:Name="ParamMappingPathTextBoxIFC" Width="200" Height="25" 
                                                                 IsEnabled="{Binding ElementName=ExportParamMappingCheckIFC, Path=IsChecked}" 
                                                                 FontSize="13" VerticalContentAlignment="Center"/>
                                                        <Button x:Name="BrowseParamMappingButtonIFC" Content="..." Width="30" Height="25" 
                                                                IsEnabled="{Binding ElementName=ExportParamMappingCheckIFC, Path=IsChecked}" 
                                                                utils:BrowseFileBehavior.TargetTextBoxName="ParamMappingPathTextBoxIFC"
                                                                utils:BrowseFileBehavior.DialogTitle="Select Parameter Mapping Table File"
                                                                utils:BrowseFileBehavior.FileFilter="Text Files (*.txt)|*.txt|All Files (*.*)|*.*"
                                                                Margin="5,0,0,0" FontSize="13"/>
                                                    </StackPanel>

                                                    <Button Content="Classification Settings..." Width="180" Height="28" 
                                                            FontSize="13" HorizontalAlignment="Left"/>
                                                </StackPanel>
                                            </GroupBox>
                                        </StackPanel>

                                        <!-- Column 3: Advanced & Import/Export Settings -->
                                        <StackPanel Grid.Column="2">
                                            <!-- Advanced -->
                                            <GroupBox Header="Advanced" BorderBrush="#E1E1E1" BorderThickness="1" Margin="0,0,0,10">
                                                <StackPanel Margin="10">
                                                    <CheckBox Content="Export parts as building elements" Margin="0,0,0,8" FontSize="13"/>
                                                    <CheckBox Content="Allow use of mixed 'Solid Model' representation" 
                                                              Margin="0,0,0,8" FontSize="13"/>
                                                    <CheckBox Content="Use active view when creating geometry" 
                                                              Margin="0,0,0,8" FontSize="13"/>
                                                    <CheckBox Content="Use family and type name for reference" 
                                                              IsChecked="True" Margin="0,0,0,8" FontSize="13"/>
                                                    <CheckBox Content="Use 2D room boundaries for room volume" 
                                                              Margin="0,0,0,8" FontSize="13"/>
                                                    <CheckBox Content="Include IFCSITE elevation in the site local placement origin" 
                                                              Margin="0,0,0,8" FontSize="12"/>
                                                    <CheckBox Content="Store IFC GUID in element after export" 
                                                              Margin="0,0,0,8" FontSize="13"/>
                                                    <CheckBox Content="Export bounding box" Margin="0,0,0,8" FontSize="13"/>
                                                    <CheckBox Content="Keep tessellated geometry as triangulation" 
                                                              Margin="0,0,0,8" FontSize="13"/>
                                                    <CheckBox Content="Use Type name only for IFCType name" 
                                                              Margin="0,0,0,8" FontSize="13"/>
                                                    <CheckBox Content="Use visible Revit name as IFCEntity name" 
                                                              Margin="0,0,0,8" FontSize="13"/>
                                                </StackPanel>
                                            </GroupBox>

                                            <!-- Import/Export Settings -->
                                            <GroupBox Header="Import/Export Settings" BorderBrush="#E1E1E1" BorderThickness="1">
                                                <StackPanel Margin="10" Orientation="Horizontal" HorizontalAlignment="Center">
                                                    <Button Content="Import..." Width="100" Height="28" Margin="0,0,10,0" FontSize="13"/>
                                                    <Button Content="Export..." Width="100" Height="28" FontSize="13"/>
                                                </StackPanel>
                                            </GroupBox>
                                        </StackPanel>
                                    </Grid>
                                </Grid>
                            </ScrollViewer>
                        </TabItem>
                    </TabControl>
                </Grid>
            </TabItem>
            
            <!-- Create Tab -->
            <TabItem x:Name="CreateTab">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <Ellipse Fill="#4CAF50" Width="8" Height="8" Margin="0,0,5,0"/>
                        <TextBlock Text="Create"/>
                    </StackPanel>
                </TabItem.Header>
                
                <Grid Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Export Rules Section -->
                    <GroupBox Grid.Row="0" Header="Export Rules" Margin="0,0,0,15" 
                              BorderBrush="#E1E1E1" BorderThickness="1">
                        <Grid Margin="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="200"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Folder Selection -->
                            <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal" Margin="0,0,0,10">
                                <TextBlock Text="Folder Selection:" VerticalAlignment="Center" Margin="0,0,10,0" FontSize="13"/>
                                <TextBox x:Name="CreateFolderPathTextBox" Width="400" Height="25" 
                                         Text="{Binding OutputFolder, UpdateSourceTrigger=PropertyChanged}"
                                         VerticalContentAlignment="Center" FontSize="13"/>
                                <Button x:Name="CreateBrowseFolderButton" Content="📁" Width="30" Height="25" 
                                        Margin="5,0,0,0" FontSize="14"
                                        utils:BrowseFileBehavior.TargetTextBoxName="CreateFolderPathTextBox"
                                        utils:BrowseFileBehavior.DialogTitle="Select Export Folder"
                                        utils:BrowseFileBehavior.IsFolderPicker="True"
                                        ToolTip="Browse for folder"/>
                            </StackPanel>

                            <!-- Environment Variables Info -->
                            <StackPanel Grid.Row="1" Grid.Column="0" Orientation="Horizontal" Margin="0,0,0,10">
                                <TextBlock Text="Supports environment variables: " VerticalAlignment="Center" FontSize="12" Foreground="#666"/>
                                <TextBlock VerticalAlignment="Center" FontSize="12">
                                    <Hyperlink NavigateUri="https://help.autodesk.com" RequestNavigate="LearnMore_RequestNavigate">
                                        <TextBlock Text="Learn More"/>
                                    </Hyperlink>
                                </TextBlock>
                            </StackPanel>

                            <!-- Save Options -->
                            <StackPanel Grid.Row="2" Grid.Column="0" Margin="0,0,0,10">
                                <RadioButton x:Name="SaveAllFilesRadio" 
                                             Content="Save all files in the same folder location" 
                                             IsChecked="True" 
                                             Margin="0,0,0,5" 
                                             FontSize="13"
                                             GroupName="SaveOptions"/>
                                <RadioButton x:Name="SaveSplitFilesRadio" 
                                             Content="Save and split files by file format" 
                                             FontSize="13"
                                             GroupName="SaveOptions"/>
                            </StackPanel>

                            <!-- Progress and Report Section -->
                            <StackPanel Grid.Row="0" Grid.RowSpan="3" Grid.Column="2" Margin="20,0,0,0">
                                <!-- Progress Bar -->
                                <TextBlock x:Name="ProgressPercentageText" 
                                           Text="Completed 0%" 
                                           FontSize="12" 
                                           Margin="0,0,0,5"/>
                                <ProgressBar x:Name="ExportProgressBar" 
                                             Height="20" 
                                             Value="0" 
                                             Maximum="100" 
                                             Margin="0,0,0,15"/>
                                
                                <!-- Report Dropdown -->
                                <TextBlock Text="Export Report:" FontSize="12" Margin="0,0,0,5"/>
                                <ComboBox x:Name="ReportComboBox" 
                                          Height="25" 
                                          Margin="0,0,0,10"
                                          FontSize="13">
                                    <ComboBoxItem Content="Don't Save Report" IsSelected="True"/>
                                    <ComboBoxItem Content="Save HTML Report"/>
                                    <ComboBoxItem Content="Save PDF Report"/>
                                    <ComboBoxItem Content="Save Text Report"/>
                                </ComboBox>
                            </StackPanel>
                        </Grid>
                    </GroupBox>

                    <!-- Export Queue DataGrid -->
                    <GroupBox Grid.Row="1" Header="Export Queue" Margin="0,0,0,15"
                              BorderBrush="#E1E1E1" BorderThickness="1">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Action Buttons -->
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,5,0,10">
                                <Button x:Name="SetPaperSizeButton" 
                                        Content="Set Paper Size" 
                                        Width="120" 
                                        Height="28" 
                                        Margin="0,0,5,0" 
                                        FontSize="12"
                                        Background="#607D8B"
                                        Foreground="White"
                                        BorderThickness="0"
                                        Click="SetPaperSizeButton_Click"
                                        ToolTip="Set paper size for selected sheets"/>
                                <Button x:Name="SetOrientationButton" 
                                        Content="Set Orientation" 
                                        Width="120" 
                                        Height="28" 
                                        FontSize="12"
                                        Background="#607D8B"
                                        Foreground="White"
                                        BorderThickness="0"
                                        Click="SetOrientationButton_Click"
                                        ToolTip="Set orientation for selected sheets"/>
                            </StackPanel>

                            <!-- Export Queue DataGrid -->
                            <DataGrid Grid.Row="1" 
                                      x:Name="ExportQueueDataGrid"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      GridLinesVisibility="Horizontal"
                                      HeadersVisibility="Column"
                                      AlternatingRowBackground="#F9F9F9"
                                      RowBackground="White"
                                      RowHeaderWidth="0"
                                      SelectionMode="Extended"
                                      BorderThickness="1"
                                      BorderBrush="#E1E1E1"
                                      ItemsSource="{Binding ExportQueueItems}">
                                
                                <DataGrid.Columns>
                                    <!-- Checkbox Column -->
                                    <DataGridCheckBoxColumn Header="✓" 
                                                           Binding="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" 
                                                           Width="35"/>
                                    
                                    <!-- View/Sheet Number -->
                                    <DataGridTextColumn Header="View/Sheet Number" 
                                                       Binding="{Binding ViewSheetNumber}" 
                                                       Width="140"
                                                       IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="SemiBold"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="Padding" Value="5,0"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    
                                    <!-- View/Sheet Name -->
                                    <DataGridTextColumn Header="View/Sheet Name" 
                                                       Binding="{Binding ViewSheetName}" 
                                                       Width="*"
                                                       IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="Padding" Value="5,0"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    
                                    <!-- Format -->
                                    <DataGridTextColumn Header="Format" 
                                                       Binding="{Binding Format}" 
                                                       Width="80"
                                                       IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                                <Setter Property="FontWeight" Value="SemiBold"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    
                                    <!-- Size -->
                                    <DataGridTextColumn Header="Size" 
                                                       Binding="{Binding Size}" 
                                                       Width="100"
                                                       IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    
                                    <!-- Orientation -->
                                    <DataGridTextColumn Header="Orientation" 
                                                       Binding="{Binding Orientation}" 
                                                       Width="90"
                                                       IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    
                                    <!-- Progress Column with ProgressBar -->
                                    <DataGridTemplateColumn Header="Progress" Width="120">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Grid Margin="5">
                                                    <ProgressBar Value="{Binding Progress}" 
                                                                Maximum="100" 
                                                                Height="18"
                                                                Background="#F0F0F0"
                                                                BorderBrush="#CCCCCC"
                                                                BorderThickness="1">
                                                        <ProgressBar.Foreground>
                                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                                <GradientStop Color="#4CAF50" Offset="0"/>
                                                                <GradientStop Color="#81C784" Offset="1"/>
                                                            </LinearGradientBrush>
                                                        </ProgressBar.Foreground>
                                                    </ProgressBar>
                                                    <TextBlock Text="{Binding Progress, StringFormat={}{0}%}" 
                                                              HorizontalAlignment="Center" 
                                                              VerticalAlignment="Center"
                                                              FontSize="10"
                                                              FontWeight="SemiBold"
                                                              Foreground="#333"/>
                                                </Grid>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    
                                    <!-- Status Column -->
                                    <DataGridTextColumn Header="Status" 
                                                       Binding="{Binding Status}" 
                                                       Width="100"
                                                       IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                                <Setter Property="FontSize" Value="11"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Status}" Value="Completed">
                                                        <Setter Property="Foreground" Value="#4CAF50"/>
                                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Status}" Value="Processing">
                                                        <Setter Property="Foreground" Value="#FF9800"/>
                                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Status}" Value="Pending">
                                                        <Setter Property="Foreground" Value="#9E9E9E"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Status}" Value="Error">
                                                        <Setter Property="Foreground" Value="#F44336"/>
                                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>

                                <DataGrid.RowStyle>
                                    <Style TargetType="DataGridRow">
                                        <Setter Property="Height" Value="32"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#F5F5F5"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.RowStyle>
                            </DataGrid>
                        </Grid>
                    </GroupBox>

                    <!-- Scheduling Assistant Section -->
                    <GroupBox Grid.Row="2" Header="Scheduling Assistant ⭐" Margin="0,0,0,10"
                              BorderBrush="#E1E1E1" BorderThickness="1">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Schedule Toggle -->
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                                <ToggleButton x:Name="ScheduleToggle" 
                                             Width="50" 
                                             Height="25" 
                                             IsChecked="False" 
                                             Checked="ScheduleToggle_Checked"
                                             Unchecked="ScheduleToggle_Unchecked">
                                    <ToggleButton.Template>
                                        <ControlTemplate TargetType="ToggleButton">
                                            <Border Background="{TemplateBinding Background}" 
                                                    BorderBrush="#CCCCCC" 
                                                    BorderThickness="1" 
                                                    CornerRadius="12">
                                                <Grid>
                                                    <Ellipse x:Name="SwitchThumb" 
                                                            Width="20" Height="20" 
                                                            Fill="White" 
                                                            HorizontalAlignment="Left" 
                                                            Margin="2"/>
                                                </Grid>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsChecked" Value="True">
                                                    <Setter Property="Background" Value="#4CAF50"/>
                                                    <Setter TargetName="SwitchThumb" Property="HorizontalAlignment" Value="Right"/>
                                                </Trigger>
                                                <Trigger Property="IsChecked" Value="False">
                                                    <Setter Property="Background" Value="#CCCCCC"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </ToggleButton.Template>
                                </ToggleButton>
                                <TextBlock Text="Schedule Publish" 
                                          VerticalAlignment="Center" 
                                          Margin="10,0,0,0" 
                                          FontSize="13"
                                          FontWeight="SemiBold"/>
                                <TextBlock x:Name="ScheduleStatusText" 
                                          Text="The Scheduling Assistant is off." 
                                          VerticalAlignment="Center" 
                                          Margin="15,0,0,0" 
                                          FontStyle="Italic"
                                          FontSize="12"
                                          Foreground="#666"/>
                                <Button x:Name="RefreshScheduleButton" 
                                       Content="🔄" 
                                       Width="28" 
                                       Height="25" 
                                       Margin="10,0,0,0" 
                                       FontSize="14"
                                       Background="#2196F3"
                                       Foreground="White"
                                       BorderThickness="0"
                                       Click="RefreshScheduleButton_Click"
                                       ToolTip="Refresh schedule settings"/>
                            </StackPanel>

                            <!-- Schedule Settings -->
                            <StackPanel Grid.Row="1" 
                                       x:Name="ScheduleSettingsPanel" 
                                       Visibility="Collapsed"
                                       Margin="0,10,0,0">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Starting Date -->
                                    <StackPanel Grid.Column="0" Margin="0,0,20,0">
                                        <TextBlock Text="Choose Starting Date" 
                                                  Margin="0,0,0,5" 
                                                  FontSize="12"
                                                  FontWeight="SemiBold"/>
                                        <DatePicker x:Name="StartingDatePicker" 
                                                   Width="150"
                                                   Height="28"
                                                   FontSize="12"/>
                                    </StackPanel>

                                    <!-- Time -->
                                    <StackPanel Grid.Column="1" Margin="0,0,20,0">
                                        <TextBlock Text="Choose Time" 
                                                  Margin="0,0,0,5" 
                                                  FontSize="12"
                                                  FontWeight="SemiBold"/>
                                        <ComboBox x:Name="TimeComboBox" 
                                                 Width="100"
                                                 Height="28"
                                                 FontSize="12">
                                            <ComboBoxItem Content="12:00 AM"/>
                                            <ComboBoxItem Content="01:00 AM"/>
                                            <ComboBoxItem Content="02:00 AM"/>
                                            <ComboBoxItem Content="03:00 AM"/>
                                            <ComboBoxItem Content="04:00 AM"/>
                                            <ComboBoxItem Content="05:00 AM"/>
                                            <ComboBoxItem Content="06:00 AM"/>
                                            <ComboBoxItem Content="07:00 AM"/>
                                            <ComboBoxItem Content="08:00 AM"/>
                                            <ComboBoxItem Content="09:00 AM"/>
                                            <ComboBoxItem Content="10:00 AM"/>
                                            <ComboBoxItem Content="11:00 AM"/>
                                            <ComboBoxItem Content="12:00 PM"/>
                                            <ComboBoxItem Content="01:00 PM"/>
                                            <ComboBoxItem Content="02:00 PM"/>
                                            <ComboBoxItem Content="03:00 PM"/>
                                            <ComboBoxItem Content="04:00 PM"/>
                                            <ComboBoxItem Content="05:00 PM"/>
                                            <ComboBoxItem Content="06:00 PM"/>
                                            <ComboBoxItem Content="07:00 PM"/>
                                            <ComboBoxItem Content="08:00 PM"/>
                                            <ComboBoxItem Content="09:00 PM"/>
                                            <ComboBoxItem Content="10:00 PM"/>
                                            <ComboBoxItem Content="11:00 PM"/>
                                        </ComboBox>
                                    </StackPanel>

                                    <!-- Repeat Options -->
                                    <StackPanel Grid.Column="2" Margin="0,0,20,0">
                                        <TextBlock Text="Repeat" 
                                                  Margin="0,0,0,5" 
                                                  FontSize="12"
                                                  FontWeight="SemiBold"/>
                                        <ComboBox x:Name="RepeatComboBox" 
                                                 Width="140"
                                                 Height="28"
                                                 FontSize="12"
                                                 SelectionChanged="RepeatComboBox_SelectionChanged">
                                            <ComboBoxItem Content="Does not repeat" IsSelected="True"/>
                                            <ComboBoxItem Content="Daily"/>
                                            <ComboBoxItem Content="Weekly"/>
                                            <ComboBoxItem Content="Monthly"/>
                                        </ComboBox>
                                    </StackPanel>

                                    <!-- Days of Week -->
                                    <StackPanel Grid.Column="3" 
                                               x:Name="DaysOfWeekPanel"
                                               Orientation="Horizontal"
                                               VerticalAlignment="Bottom"
                                               Visibility="Collapsed">
                                        <CheckBox x:Name="MondayCheck" Content="Mon" Margin="0,0,10,0" FontSize="12"/>
                                        <CheckBox x:Name="TuesdayCheck" Content="Tue" Margin="0,0,10,0" FontSize="12"/>
                                        <CheckBox x:Name="WednesdayCheck" Content="Wed" Margin="0,0,10,0" FontSize="12"/>
                                        <CheckBox x:Name="ThursdayCheck" Content="Thu" Margin="0,0,10,0" FontSize="12"/>
                                        <CheckBox x:Name="FridayCheck" Content="Fri" Margin="0,0,10,0" FontSize="12"/>
                                        <CheckBox x:Name="SaturdayCheck" Content="Sat" Margin="0,0,10,0" FontSize="12"/>
                                        <CheckBox x:Name="SundayCheck" Content="Sun" FontSize="12"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>

                            <!-- Start Export Button -->
                            <Button Grid.Row="2" 
                                   x:Name="StartExportButton" 
                                   Content="START EXPORT" 
                                   Height="40" 
                                   FontSize="14" 
                                   FontWeight="Bold"
                                   Background="#4CAF50" 
                                   Foreground="White"
                                   BorderThickness="0"
                                   HorizontalAlignment="Center"
                                   Width="200"
                                   Margin="0,15,0,0"
                                   Click="StartExportButton_Click">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}" 
                                                            CornerRadius="3" 
                                                            BorderThickness="0">
                                                        <ContentPresenter HorizontalAlignment="Center" 
                                                                         VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="#45A049"/>
                                                        </Trigger>
                                                        <Trigger Property="IsEnabled" Value="False">
                                                            <Setter Property="Background" Value="#CCCCCC"/>
                                                            <Setter Property="Foreground" Value="#666666"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </Grid>
                    </GroupBox>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Bottom Section -->
        <Border Grid.Row="1" BorderBrush="LightGray" BorderThickness="0,1,0,0" Padding="15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Button Grid.Column="1" x:Name="BackButton" Content="Back" 
                        Style="{StaticResource SecondaryButtonStyle}"
                        Width="80" Height="40" Margin="0,0,10,0"
                        IsEnabled="False"
                        Click="BackButton_Click"/>
                <Button Grid.Column="2" x:Name="NextButton" Content="Next" 
                        Style="{StaticResource PrimaryButtonStyle}"
                        Width="80" Height="40"
                        Click="NextButton_Click"/>
            </Grid>
        </Border>
    </Grid>
</Window>